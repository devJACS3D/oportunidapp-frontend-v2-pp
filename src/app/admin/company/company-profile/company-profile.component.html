<ng-container *ngIf="!_loadingInit; else loadingInit">
  <div class="row" *ngIf="_error == ''; else loadingError">
    <div class="col-auto text-center">
      <div
        class="img-rounded"
        [style.background]="'url(' + _userImage.Url + ')'"
        style="width: 12rem; height: 12rem; position: relative;"
      >
        <input
          type="file"
          (change)="onInputImageChange($event)"
          id="inputUpload"
          accept="image/*"
          style="display: none;"
        />
        <label for="inputUpload" style="cursor: pointer;">
          <span class="fa-stack fa-lg edit-icon">
            <i class="fa fa-circle fa-stack-2x"></i>
            <i class="fa fa-pencil fa-stack-1x fa-inverse"></i>
          </span>
        </label>
      </div>
      <div class="col-12" *ngIf="_userImage.Name">
        {{ _userImage.Name | truncate: 20 }}
      </div>
      <div class="col-12 mt-2 mb-2" *ngIf="_userImage.Name">
        <button
          [disabled]="_loadingImg"
          class="btn btn-ok btn-outline-secondary"
          (click)="saveImg()"
        >
          <i
            *ngIf="_loadingImg"
            class="fa fa-circle-o-notch fa-spin"
            aria-hidden="true"
          ></i>
          Guardar cambios
        </button>
      </div>
      <!-- <div class="col-12 ">
        <ng-container *ngIf="buttonCanRate$ | async; let button">
          <ng-container *ngIf="!button.qualified">
            <button class="mt-3 btn-ok--blue btn" (click)="companyCanRate()">
              Calificar Plataforma
            </button>
          </ng-container>
        </ng-container>
      </div> -->
    </div>

    <div class="col">
      <h4 class="text-secondary">Mi cuenta</h4>

      <div class="card">
        <div class="card-body card-body--header">
          <span class="h5">Datos personles</span>
        </div>
      </div>

      <div class="card">
        <div class="card-body px-4">
          <ng-container *ngIf="!_editMode">
            <div class="row">
              <div class="col">
                <label class="font-weight-bold mb-0">Razón social</label>
                <p class="text-secondary">{{ currentUser.name }}</p>
              </div>
              <div class="col">
                <label class="font-weight-bold mb-0">N.I.T.</label>
                <p class="text-secondary">{{ currentUser.nit }}</p>
              </div>
              <div class="col">
                <label class="font-weight-bold mb-0">CIIU</label>
                <p class="text-secondary">{{ currentUser.ciiu }}</p>
              </div>
            </div>

            <div class="row">
              <div class="col">
                <label class="font-weight-bold mb-0">Actividad económica</label>
                <p class="text-secondary">{{ currentUser.economicActivity }}</p>
              </div>
              <div class="col">
                <label class="font-weight-bold mb-0"
                  >Tipo de contribuyente</label
                >
                <p class="text-secondary">{{ currentUser.typeOfTaxPayer }}</p>
              </div>
              <div class="col">
                <label class="font-weight-bold mb-0"
                  >Retenedor a título de renta</label
                >
                <p class="text-secondary">
                  {{ currentUser.retainerTitleRent }}
                </p>
              </div>
            </div>

            <div class="row">
              <div class="col">
                <label class="font-weight-bold mb-0">Departamento</label>
                <p class="text-secondary">
                  {{ currentUser.retainerTitleRent }}
                </p>
              </div>
              <div class="col">
                <label class="font-weight-bold mb-0">Ciudad</label>
                <p class="text-secondary">{{ currentUser.city?.name }}</p>
              </div>
              <div class="col">
                <label class="font-weight-bold mb-0">Dirección</label>
                <p class="text-secondary">{{ currentUser.address }}</p>
              </div>
            </div>

            <div class="row">
              <div class="col-md-4">
                <label class="font-weight-bold mb-0">Teléfono</label>
                <p class="text-secondary">{{ currentUser.telephones }}</p>
              </div>
            </div>

            <hr />
            <div class="row mt-3">
              <div class="col">
                <h4>Representante Legal</h4>
              </div>
            </div>
            <div class="row">
              <div class="col">
                <label class="font-weight-bold mb-0">Nombre</label>
                <p class="text-secondary">
                  {{ currentUser.legalRepresentativeName }}
                </p>
              </div>
              <div class="col">
                <label class="font-weight-bold mb-0">Cédula</label>
                <p class="text-secondary">
                  {{ currentUser.dniLegalRepresentative }}
                </p>
              </div>
            </div>
            <div class="row">
              <div class="col">
                <label class="font-weight-bold mb-0"
                  >Departamento expedición</label
                >
                <p class="text-secondary">
                  {{ currentUser.expeditionCity?.name }}
                </p>
              </div>
              <div class="col">
                <label class="font-weight-bold mb-0">Ciudad expedición</label>
                <p class="text-secondary">
                  {{ currentUser.expeditionCity?.stateId }}
                </p>
              </div>
            </div>

            <hr />
            <div class="row mt-3">
              <div class="col">
                <h4>Contacto principal</h4>
              </div>
            </div>
            <div class="row">
              <div class="col">
                <label class="font-weight-bold mb-0">Nombre</label>
                <p class="text-secondary">{{ currentUser.contactName }}</p>
              </div>
              <div class="col">
                <label class="font-weight-bold mb-0">Cargo</label>
                <p class="text-secondary">{{ currentUser.positionContact }}</p>
              </div>
              <div class="col">
                <label class="font-weight-bold mb-0">Celular</label>
                <p class="text-secondary">{{ currentUser.cellphoneContact }}</p>
              </div>
            </div>
            <div class="row">
              <div class="col">
                <label class="font-weight-bold mb-0">Teléfono</label>
                <p class="text-secondary">{{ currentUser.telephoneContact }}</p>
              </div>
              <div class="col">
                <label class="font-weight-bold mb-0">Ext</label>
                <p class="text-secondary">
                  {{ currentUser.extTelephoneContact }}
                </p>
              </div>
              <div class="col">
                <label class="font-weight-bold mb-0">Correo electrónico</label>
                <p class="text-secondary">{{ currentUser.emailContact }}</p>
              </div>
            </div>
            <!--Planes -->
            <div class="row mt-3">
              <div class="col">
                <h4 (click)="loadPacks()">Planes</h4>
              </div>
            </div>
            <div class="row">
              <div class="col">
                <p class="text-secondary" *ngIf="packs.length == 0">
                  No tiene planes contratados
                </p>
                <ng-container *ngIf="packs.length > 0">
                  <p
                    class="text-secondary font-weight-bold"
                    *ngFor="let item of packs"
                  >
                    {{ item._label }}: {{ item.count }} Publicaciones
                    Disponibles
                  </p>
                </ng-container>
              </div>
            </div>

            <div class="row">
              <div class="w-100"></div>

              <div class="col-12 text-right">
                <button class="btn btn-ok btn-ok--blue" (click)="editProfile()">
                  Editar perfil
                </button>
              </div>
            </div>

            <!-- <div class="row">
							<div class="col-6">
								<label class="font-weight-bold mb-0">Razón social</label>
								<p class="text-secondary"> {{ currentUser.name }} </p>
							</div>
							<div class="col-6">
								<label class="font-weight-bold mb-0">N.I.T.</label>
								<p class="text-secondary"> {{ currentUser.nit | mask: '999999999-9' }} </p>
							</div>
							<div class="col-6">
								<label class="font-weight-bold mb-0">Usuario</label>
								<p class="text-secondary"> {{ currentUser.username }} </p>
							</div>
							<div class="col-6">
								<label class="font-weight-bold mb-0">Correo electrónico</label>
								<p class="text-secondary"> {{ currentUser.email }} </p>
							</div>

							<div class="col-6">
								<label class="font-weight-bold mb-0">Dirección</label>
								<p class="text-secondary"> {{ currentUser.address }} </p>
							</div>
							<div class="col-6">
								<label class="font-weight-bold mb-0">Telefonos</label>
								<p class="text-secondary"> {{ currentUser.telephones }} </p>
							</div>

							<div class="col-6">
								<label class="font-weight-bold mb-0">Ciudad</label>
								<p class="text-secondary"> {{ currentUser.city?.name }} </p>
							</div>

							<div class="w-100"></div>

							<div class="col-12 text-right">
								<button class="btn btn-ok btn-ok--blue" (click)="editProfile()">
									Editar perfil
								</button>
							</div>
						</div> -->
          </ng-container>

          <ng-container *ngIf="_editMode">
            <form [formGroup]="FormEntity">
              <div class="row">
                <div class="col form-group">
                  <label class="font-weight-bold">Razón social</label>
                  <input
                    type="text"
                    class="form-control input-2"
                    formControlName="name"
                    maxlength="100"
                  />
                  <!-- <span class="text-danger invalid-control"
										*ngIf="FormEntity.controls.name.invalid && FormEntity.controls.name.dirty">
										Campo requerido.
									</span> -->
                </div>

                <div class="col form-group">
                  <label class="font-weight-bold">N.I.T.</label>
                  <input
                    type="text"
                    class="form-control input-2"
                    formControlName="nit"
                    mask="999999999-9"
                    maxlength="11"
                  />
                </div>
                <div class="col form-group">
                  <label class="font-weight-bold">CIIU</label>
                  <input
                    type="text"
                    class="form-control input-2"
                    formControlName="ciiu"
                    maxlength="100"
                  />
                </div>
              </div>
              <div class="row">
                <div class="col form-group">
                  <label class="font-weight-bold">Actividad económica</label>
                  <input
                    type="text"
                    class="form-control input-2"
                    formControlName="economicActivity"
                    maxlength="100"
                  />
                </div>
                <div class="col form-group">
                  <label class="font-weight-bold">Tipo de contribuyente</label>
                  <!-- 	
									<input type="text" class="form-control input-2" formControlName="typeOfTaxPayer"
										maxlength="100"> -->
                  <select
                    class="form-control input-2"
                    formControlName="typeOfTaxPayer"
                  >
                    <option value="">Seleccionar</option>
                    <option value="Gran Contribuyente"
                      >Gran Contribuyente</option
                    >
                    <option value="Mediano Contribuyente"
                      >Mediano Contribuyente</option
                    >
                    <option value="Pequeño Contribuyente"
                      >Pequeño Contribuyente</option
                    >
                  </select>
                </div>
                <div class="col form-group">
                  <label class="font-weight-bold"
                    >Retenedor a título de renta</label
                  >
                  <input
                    type="text"
                    class="form-control input-2"
                    formControlName="retainerTitleRent"
                    maxlength="100"
                  />
                </div>
              </div>

              <div class="row">
                <div class="col form-group">
                  <label class="font-weight-bold">Departamento</label>
                  <select
                    class="form-control input-2"
                    formControlName="stateId"
                    (change)="changeDepartment(1)"
                  >
                    <option value="">Seleccionar</option>
                    <option *ngFor="let state of _states" [value]="state.id">
                      {{ state.name }}
                    </option>
                  </select>
                </div>
                <div class="col form-group">
                  <label class="font-weight-bold">Ciudad</label>
                  <select
                    class="form-control input-2"
                    formControlName="cityId"
                    [ngClass]="{ 'select-loading': _loadingCities }"
                  >
                    <option value="">Seleccionar</option>
                    <option *ngFor="let city of _cities" [value]="city.id">
                      {{ city.name }}
                    </option>
                  </select>
                </div>
                <div class="col form-group">
                  <label class="font-weight-bold">Dirección</label>
                  <input
                    type="text"
                    class="form-control input-2"
                    formControlName="address"
                    maxlength="100"
                  />
                </div>
              </div>

              <div class="row">
                <div class="col-md-4 form-group">
                  <label class="font-weight-bold">Teléfono</label>
                  <input
                    type="text"
                    class="form-control input-2"
                    formControlName="telephones"
                    [patterns]="_maskPhone"
                    mask="ABBBBBBBBBBBBBB"
                    [validation]="false"
                    [dropSpecialCharacters]="false"
                    maxlength="15"
                  />
                </div>
                <div class="col-md-4 form-group">
                  <label class="font-weight-bold">Nombre Comercial</label>
                  <input
                    type="text"
                    class="form-control input-2"
                    formControlName="nameComercial"
                    maxlength="100"
                  />
                </div>
              </div>

              <hr />
              <div class="row mt-3">
                <div class="col">
                  <h4>Representante Legal</h4>
                </div>
              </div>
              <div class="row">
                <div class="col form-group">
                  <label class="font-weight-bold">Nombre</label>
                  <input
                    type="text"
                    class="form-control input-2"
                    formControlName="legalRepresentativeName"
                    maxlength="100"
                  />
                </div>
                <div class="col form-group">
                  <label class="font-weight-bold">Cédula</label>
                  <input
                    type="numeric"
                    class="form-control input-2"
                    formControlName="dniLegalRepresentative"
                    maxlength="15"
                  />
                </div>
              </div>
              <div class="row">
                <div class="col form-group">
                  <label class="font-weight-bold"
                    >Departamento expedición</label
                  >
                  <select
                    class="form-control input-2"
                    formControlName="expeditionStateId"
                    (change)="changeDepartment(2)"
                  >
                    <option value="">Seleccionar</option>
                    <option *ngFor="let state of _states" [value]="state.id">
                      {{ state.name }}
                    </option>
                  </select>
                </div>
                <div class="col form-group">
                  <label class="font-weight-bold">Ciudad expedición</label>
                  <select
                    class="form-control input-2"
                    formControlName="expeditionCityId"
                    [ngClass]="{ 'select-loading': _loadingExpeditionCities }"
                  >
                    <option value="">Seleccionar</option>
                    <option
                      *ngFor="let city of _expeditionCities"
                      [value]="city.id"
                    >
                      {{ city.name }}
                    </option>
                  </select>
                </div>
              </div>

              <hr />
              <div class="row mt-3">
                <div class="col">
                  <h4>Contacto principal</h4>
                </div>
              </div>

              <div class="row">
                <div class="col form-group">
                  <label class="font-weight-bold">Nombre</label>
                  <input
                    type="text"
                    class="form-control input-2"
                    formControlName="contactName"
                    maxlength="100"
                  />
                </div>
                <div class="col form-group">
                  <label class="font-weight-bold">Cargo</label>
                  <input
                    type="text"
                    class="form-control input-2"
                    formControlName="positionContact"
                    maxlength="100"
                  />
                </div>
                <div class="col form-group">
                  <label class="font-weight-bold">Celular</label>
                  <input
                    type="text"
                    class="form-control input-2"
                    formControlName="cellphoneContact"
                    [patterns]="_maskPhone"
                    mask="ABBBBBBBBBBBBBB"
                    [validation]="false"
                    [dropSpecialCharacters]="false"
                    maxlength="15"
                  />
                </div>
              </div>

              <div class="row">
                <div class="col form-group">
                  <label class="font-weight-bold">Teléfono</label>
                  <input
                    type="text"
                    class="form-control input-2"
                    formControlName="telephoneContact"
                    [patterns]="_maskPhone"
                    mask="ABBBBBBBBBBBBBB"
                    [validation]="false"
                    [dropSpecialCharacters]="false"
                    maxlength="15"
                  />
                </div>
                <div class="col-2 form-group">
                  <label class="font-weight-bold">Ext</label>
                  <input
                    type="text"
                    class="form-control input-2"
                    formControlName="extTelephoneContact"
                    [patterns]="_maskPhone"
                    mask="ABBBBB"
                    [validation]="false"
                    [dropSpecialCharacters]="false"
                    maxlength="6"
                  />
                </div>
                <div class="col form-group">
                  <label class="font-weight-bold">Correo electrónico</label>
                  <input
                    type="text"
                    class="form-control input-2"
                    formControlName="emailContact"
                    maxlength="60"
                  />
                </div>
              </div>

              <hr />
              <div class="row mt-3">
                <div class="col">
                  <h4>Número de empleados</h4>
                </div>
              </div>

              <div class="row">
                <div class="col form-group">
                  <label class="font-weight-bold">Directos</label>
                  <input
                    type="text"
                    class="form-control input-2"
                    formControlName="numberWorkersDirect"
                    mask="00000"
                    [validation]="false"
                  />
                </div>
                <div class="col form-group">
                  <label class="font-weight-bold">Temporales</label>
                  <input
                    type="text"
                    class="form-control input-2"
                    formControlName="numberWorkersTemporals"
                    mask="00000"
                    [validation]="false"
                  />
                </div>
                <div class="col form-group">
                  <label class="font-weight-bold">Otros</label>
                  <input
                    type="text"
                    class="form-control input-2"
                    formControlName="numberWorkersOthers"
                    mask="00000"
                    [validation]="false"
                  />
                </div>
              </div>
              <div class="row">
                <div class="col-auto form-group">
                  <label class="font-weight-bold"
                    >a ingresar por Logística Laboral S.A.S</label
                  >
                  <input
                    type="text"
                    class="form-control input-2"
                    formControlName="numberWorkersToFind"
                    mask="00000"
                    [validation]="false"
                  />
                </div>
              </div>

              <div class="row mb-3" *ngIf="_errorMessage">
                <div class="col text-center">
                  <div class="alert alert-danger" role="alert">
                    {{ _errorMessage }}
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col text-center">
                  <button
                    class="btn btn-light mr-3"
                    (click)="_editMode = false"
                  >
                    Cancelar
                  </button>

                  <button
                    class="btn btn-ok btn-ok--blue"
                    [disabled]="_loading"
                    (click)="save()"
                    style="min-width: 120px;"
                  >
                    <i
                      *ngIf="_loading"
                      class="fa fa-circle-o-notch fa-spin"
                      aria-hidden="true"
                    ></i>
                    Guardar cambios
                  </button>
                </div>
              </div>
            </form>
          </ng-container>
        </div>
      </div>
    </div>
  </div>
</ng-container>

<ng-template #loadingError>
  <div class="row">
    <div class="col text-center text-secondary">
      <i class="fa fa-inbox fa-4x" aria-hidden="true"></i>
      <h4 class="h4 ">
        Error cargando información de usuario
      </h4>
      <p class="text-center">
        {{ _error }}
      </p>
    </div>
  </div>
</ng-template>

<ng-template #loadingInit>
  <div class="row">
    <div class="col">
      Cargando...
    </div>
  </div>
</ng-template>
